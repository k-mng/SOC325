library(dplyr)
getwd()
# wd() is /SOC/project
day <- read.csv("/day.csv")
# wd() is /SOC/project
day <- read.csv("day.csv")
View(day)
library(c(dplyr, ggplot))
library(ggplot2)
# weathersit = "weather situation"; 1 is Clear, Few clouds, Partly cloudy, Partly cloudy
#                                   2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist
#                                   3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds
#                                   4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog
hour <- read.csv("hour.csv")
View(hour)
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt)
View(popular_time)
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(mean(cnt))
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round(mean(cnt)), 2)
summarise(round(mean(cnt), 2)
# What times are bikes being used the most?
popular_time <- hour %>%
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round((mean(cnt), 2)))
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round((mean(cnt)), 2))
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round((mean(cnt)), 2)) %>%
rename("# Bikes Being Used" = round((mean(cnt)), 2))
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round((mean(cnt)), 2)) %>%
rename("# Bikes Being Used" = round((mean(cnt)), 2))
popular_time <- hour
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round((mean(cnt)), 2)) %>%
rename("# Bikes Being Used" = round((mean(cnt)), 2))
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round((mean(cnt)), 2))
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarise(round((mean(cnt)), 2)) %>%
rename("# Bikes Being Used" = "round((mean(cnt)), 2)")
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr)
View(popular_time)
# make a scatterplot?
scatter_time <- popular_time %>%
ggplot(x = hour,
y = cnt) + geom_point()
scatter_time
# make a scatterplot?
scatter_time <- popular_time %>%
ggplot(aes(x = hour,
y = cnt)) + geom_point()
scatter_time
# make a scatterplot?
scatter_time <- popular_time %>%
ggplot(aes(x = hr,
y = cnt)) + geom_point()
scatter_time
rm(scatter_time)
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarize(round(mean(cnt),2))
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarize(round(mean(cnt),2)) %>%
rename(average = "round(mean(cnt),2)")
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarize(round(mean(cnt),2)) %>%
rename(average = "round(mean(cnt),2)")
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarize(round(mean(cnt), 2))
# What times are bikes being used the most?
popular_time <- hour %>%
select(hr, cnt) %>%
group_by(hr) %>%
summarize(round(mean(cnt), 2)) %>%
rename(average = "round(mean(cnt), 2)")
# make a pie chart
pie_time <- popular_time %>%
ggplot(aes(x = "",
y = cnt,
fill = hr)) + geom_bar(stat = "identity",
width = 1) +
coord_polar("y", start = 0)
pie_time
# make a pie chart
pie_time <- popular_time %>%
ggplot(aes(x = "",
y = average,
fill = hr)) + geom_bar(stat = "identity",
width = 1) +
coord_polar("y", start = 0)
pie_time
pie_time
column_time
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col()
library(dplyr)
library(ggplot2)
column_time
# testing
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col()
column_time
# make a bar graph to show most pop. hour
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col() + ggtitle("# Users vs. Hour of Day", subtitle = waiver("In Military Time"))
# make a bar graph to show most pop. hour
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col() + ggtitle("# Users vs. Hour of Day", subtitle = waiver(In Military Time))
# make a bar graph to show most pop. hour
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col() + ggtitle("# Users vs. Hour of Day", subtitle = waiver())
column_time
# make a bar graph to show most pop. hour
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col() + ggtitle("# Users vs. Hour of Day")
column_time
# make a bar graph to show most pop. hour
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col() + ggtitle("# of Users vs. Hour of Day") + ylab("# of Users") + xlab("Hour of Day")
column_time
# make a bar graph to show most pop. hour
column_time <- popular_time %>%
ggplot(aes(x = hr,
y = average)) + geom_col() + ggtitle("Average # of Users vs. Hour of Day") + ylab("Average # of Users") + xlab("Hour of Day")
column_time
View(day)
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
cas_day <- day %>%
select(instant, holiday, weekday, workingday)
View(cas_day)
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(instant, holiday, weekday, workingday, casual)
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(holiday, weekday, workingday, casual)
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual)
library(stringr)
# Questions that need to be answered are:
#    What time are most bikes in use
#    Casual users weekdays vs. weekends/pop. day of the week
#    Does weather have an effect on users? (popular weather)
day <- read.csv("day.csv")
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(workingday = str_replace(workingday, c("0", "6"), "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(workingday = str_replace(workingday, c("0"), "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace(weekday, c("0"), "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace(weekday, c(0, 6), "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace_all(weekday, c(0, 6), "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace(weekday, c(0, 6), "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace(weekday, 0, "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace(weekday, "0", "Weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace(weekday, "0", "Weekend")) %>%
mutate(weekday = str_replace(weekday, "6", "weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace(weekday,
"weekend" = c("6"),
"weekday" = "[12345]"))
rlang::last_error()
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace_all(weekday,
"weekday" = "[12345]"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace_all(weekday, "[12345]", "weekday"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace_all(weekday, "[12345]", "weekday")) %>%
mutate(weekday = str_replace_all(weekday, "[06]", "weekend"))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace_all(weekday, "[12345]", "weekday")) %>%
mutate(weekday = str_replace_all(weekday, "[06]", "weekend")) %>%
mutate(weekday = ifelse(holiday == 1, "weekend", weekday))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, workingday, casual) %>%
mutate(weekday = str_replace_all(weekday, "[12345]", "weekday")) %>%
mutate(weekday = str_replace_all(weekday, "[06]", "weekend")) %>%
mutate(weekday = ifelse(holiday == 1, "holiday", weekday))
#-------------------------------------------------------------------------------
# Casual users weekdays vs. weekends
# $weekday: 0 = Sunday, 6 = Saturday
cas_day <- day %>%
select(dteday, holiday, weekday, casual) %>%
mutate(weekday = str_replace_all(weekday, "[12345]", "weekday")) %>%
mutate(weekday = str_replace_all(weekday, "[06]", "weekend")) %>%
mutate(weekday = ifelse(holiday == 1, "holiday", weekday))
